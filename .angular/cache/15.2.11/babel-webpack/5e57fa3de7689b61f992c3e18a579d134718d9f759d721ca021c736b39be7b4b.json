{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nimport { jwtDecode } from 'jwt-decode';\nimport Swal from 'sweetalert2';\nlet LoginComponent = class LoginComponent {\n  constructor(clienteService, router) {\n    this.clienteService = clienteService;\n    this.router = router;\n    // Campos enlazados con ngModel\n    this.correo = '';\n    this.contrasena = '';\n    // Mensajes de feedback\n    this.mensajeExito = '';\n    this.mensajeError = '';\n  }\n  // iniciarSesion(formValue: any): void {\n  //   const credentials = {\n  //     correo: this.correo,\n  //     contrasena: this.contrasena // ⚠️ el backend espera \"password\"\n  //   };\n  //   this.clienteService.loginCliente(credentials).subscribe({\n  //     next: (res: any) => {\n  //       if (res.token) {\n  //         //localStorage.setItem('token', res.token);\n  //         //localStorage.setItem('id_cliente', res.id_cliente);\n  //         this.mensajeExito = '✅ Login exitoso';\n  //         this.mensajeError = '';\n  //         // Redirige al perfil o dashboard\n  //         this.router.navigate(['/cliente/dashboard']);\n  //       }\n  //     },\n  //     error: (err: any) => {\n  //       console.error('Error en login:', err);\n  //       this.mensajeError = '❌ Credenciales inválidas';\n  //       this.mensajeExito = '';\n  //     }\n  //   });\n  // }\n  iniciarSesion(form) {\n    const credentials = {\n      correo: this.correo,\n      contrasena: this.contrasena\n    };\n    this.clienteService.loginCliente(credentials).subscribe({\n      next: res => {\n        if (res.token) {\n          localStorage.setItem('token', res.token);\n          const payload = jwtDecode(res.token);\n          localStorage.setItem('id_cliente', payload.id_cliente);\n          this.mensajeExito = '✅ Login exitoso';\n          this.mensajeError = '';\n          this.router.navigate(['/cliente/dashboard']);\n        }\n      },\n      error: err => {\n        console.error('Error en login:', err);\n        Swal.fire({\n          icon: \"error\",\n          title: \"Credenciales inválidas\",\n          text: \"El correo o la contraseña no son correctos. Por favor, comprueba tus credenciales e intenta de nuevo.\",\n          confirmButtonText: \"Aceptar\"\n        });\n      }\n    });\n  }\n  volverAlInicio() {\n    this.router.navigate(['/']); // redirige al inicio\n  }\n\n  redirigirRegistro() {\n    this.router.navigate(['/register']); // redirige al registro\n  }\n};\n\nLoginComponent = __decorate([Component({\n  selector: 'app-login',\n  templateUrl: './login.component.html',\n  styleUrls: ['./login.component.scss']\n})], LoginComponent);\nexport { LoginComponent };","map":{"version":3,"mappings":";AAAA,SAASA,SAAS,QAAQ,eAAe;AAGzC,SAASC,SAAS,QAAQ,YAAY;AACtC,OAAOC,IAAI,MAAM,aAAa;AAQvB,IAAMC,cAAc,GAApB,MAAMA,cAAc;EASzBC,YAAoBC,cAA8B,EAAUC,MAAc;IAAtD,mBAAc,GAAdD,cAAc;IAA0B,WAAM,GAANC,MAAM;IARlE;IACA,WAAM,GAAW,EAAE;IACnB,eAAU,GAAW,EAAE;IAEvB;IACA,iBAAY,GAAW,EAAE;IACzB,iBAAY,GAAW,EAAE;EAEqD;EAE9E;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EACA;EAEAC,aAAa,CAACC,IAAY;IAExB,MAAMC,WAAW,GAAG;MAClBC,MAAM,EAAE,IAAI,CAACA,MAAM;MACnBC,UAAU,EAAE,IAAI,CAACA;KAClB;IAED,IAAI,CAACN,cAAc,CAACO,YAAY,CAACH,WAAW,CAAC,CAACI,SAAS,CAAC;MACtDC,IAAI,EAAGC,GAAQ,IAAI;QACjB,IAAIA,GAAG,CAACC,KAAK,EAAE;UACbC,YAAY,CAACC,OAAO,CAAC,OAAO,EAAEH,GAAG,CAACC,KAAK,CAAC;UACxC,MAAMG,OAAO,GAAQlB,SAAS,CAACc,GAAG,CAACC,KAAK,CAAC;UACzCC,YAAY,CAACC,OAAO,CAAC,YAAY,EAAEC,OAAO,CAACC,UAAU,CAAC;UACtD,IAAI,CAACC,YAAY,GAAG,iBAAiB;UACrC,IAAI,CAACC,YAAY,GAAG,EAAE;UACtB,IAAI,CAAChB,MAAM,CAACiB,QAAQ,CAAC,CAAC,oBAAoB,CAAC,CAAC;;MAEhD,CAAC;MACDC,KAAK,EAAGC,GAAQ,IAAI;QAClBC,OAAO,CAACF,KAAK,CAAC,iBAAiB,EAAEC,GAAG,CAAC;QACrCvB,IAAI,CAACyB,IAAI,CAAC;UACRC,IAAI,EAAE,OAAO;UACbC,KAAK,EAAE,wBAAwB;UAC/BC,IAAI,EAAE,uGAAuG;UAC7GC,iBAAiB,EAAE;SACpB,CAAC;MACJ;KACD,CAAC;EACJ;EAEAC,cAAc;IACZ,IAAI,CAAC1B,MAAM,CAACiB,QAAQ,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;EAC/B;;EAEAU,iBAAiB;IACf,IAAI,CAAC3B,MAAM,CAACiB,QAAQ,CAAC,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;EACvC;CACD;;AAxEYpB,cAAc,eAL1BH,SAAS,CAAC;EACTkC,QAAQ,EAAE,WAAW;EACrBC,WAAW,EAAE,wBAAwB;EACrCC,SAAS,EAAE,CAAC,wBAAwB;CACrC,CAAC,GACWjC,cAAc,CAwE1B;SAxEYA,cAAc","names":["Component","jwtDecode","Swal","LoginComponent","constructor","clienteService","router","iniciarSesion","form","credentials","correo","contrasena","loginCliente","subscribe","next","res","token","localStorage","setItem","payload","id_cliente","mensajeExito","mensajeError","navigate","error","err","console","fire","icon","title","text","confirmButtonText","volverAlInicio","redirigirRegistro","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["G:\\FrontendReyshell\\proyecto-web-soporte\\src\\app\\auth\\login\\login.component.ts"],"sourcesContent":["import { Component } from '@angular/core';\r\nimport { ClienteService } from 'src/app/services/cliente.service';\r\nimport { Router } from '@angular/router';\r\nimport { jwtDecode } from 'jwt-decode';\r\nimport Swal from 'sweetalert2';\r\nimport { NgForm } from '@angular/forms';\r\n\r\n@Component({\r\n  selector: 'app-login',\r\n  templateUrl: './login.component.html',\r\n  styleUrls: ['./login.component.scss']\r\n})\r\nexport class LoginComponent {\r\n  // Campos enlazados con ngModel\r\n  correo: string = '';\r\n  contrasena: string = '';\r\n\r\n  // Mensajes de feedback\r\n  mensajeExito: string = '';\r\n  mensajeError: string = '';\r\n\r\n  constructor(private clienteService: ClienteService, private router: Router) { }\r\n\r\n  // iniciarSesion(formValue: any): void {\r\n  //   const credentials = {\r\n  //     correo: this.correo,\r\n  //     contrasena: this.contrasena // ⚠️ el backend espera \"password\"\r\n  //   };\r\n  //   this.clienteService.loginCliente(credentials).subscribe({\r\n  //     next: (res: any) => {\r\n  //       if (res.token) {\r\n  //         //localStorage.setItem('token', res.token);\r\n  //         //localStorage.setItem('id_cliente', res.id_cliente);\r\n  //         this.mensajeExito = '✅ Login exitoso';\r\n  //         this.mensajeError = '';\r\n  //         // Redirige al perfil o dashboard\r\n  //         this.router.navigate(['/cliente/dashboard']);\r\n  //       }\r\n  //     },\r\n  //     error: (err: any) => {\r\n  //       console.error('Error en login:', err);\r\n  //       this.mensajeError = '❌ Credenciales inválidas';\r\n  //       this.mensajeExito = '';\r\n  //     }\r\n  //   });\r\n  // }\r\n\r\n  iniciarSesion(form: NgForm): void {\r\n\r\n    const credentials = {\r\n      correo: this.correo,\r\n      contrasena: this.contrasena\r\n    };\r\n\r\n    this.clienteService.loginCliente(credentials).subscribe({\r\n      next: (res: any) => {\r\n        if (res.token) {\r\n          localStorage.setItem('token', res.token);\r\n          const payload: any = jwtDecode(res.token);\r\n          localStorage.setItem('id_cliente', payload.id_cliente);\r\n          this.mensajeExito = '✅ Login exitoso';\r\n          this.mensajeError = '';\r\n          this.router.navigate(['/cliente/dashboard']);\r\n        }\r\n      },\r\n      error: (err: any) => {\r\n        console.error('Error en login:', err);\r\n        Swal.fire({\r\n          icon: \"error\",\r\n          title: \"Credenciales inválidas\",\r\n          text: \"El correo o la contraseña no son correctos. Por favor, comprueba tus credenciales e intenta de nuevo.\",\r\n          confirmButtonText: \"Aceptar\",\r\n        });\r\n      }\r\n    });\r\n  }\r\n\r\n  volverAlInicio(): void {\r\n    this.router.navigate(['/']); // redirige al inicio\r\n  }\r\n\r\n  redirigirRegistro(): void {\r\n    this.router.navigate(['/register']); // redirige al registro\r\n  }\r\n}\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}