{"ast":null,"code":"import { __decorate } from \"tslib\";\nimport { Component } from '@angular/core';\nlet ServiciosComponent = class ServiciosComponent {\n  constructor(modalidadService, distritoService, horarioService, servicioService, tarifaService, clienteService) {\n    this.modalidadService = modalidadService;\n    this.distritoService = distritoService;\n    this.horarioService = horarioService;\n    this.servicioService = servicioService;\n    this.tarifaService = tarifaService;\n    this.clienteService = clienteService;\n    this.servicios = [];\n    //programasInstalacion: any[] = [];\n    //programasReparacion: any[] = [];\n    this.modalidades = [];\n    this.distritos = [];\n    this.horarios = [];\n    this.tarifasDomicilio = [];\n    this.cliente = {};\n    this.nombreCompleto = '';\n    this.servicio = {\n      descripcion_servicio: '',\n      modalidad: '',\n      distrito: '',\n      direccion: '',\n      fecha: '',\n      hora: '',\n      id_cliente: this.cliente.id_cliente,\n      documento: '',\n      comentario: '',\n      precio_serviciot: 0.00,\n      precio_domicilio: 0.00\n    };\n    this.idServicioSeleccionado = '';\n    this.precioSeleccionado = 0.00;\n    this.fechaMinima = '';\n    this.idDistritoSeleccionado = '';\n    this.precioTarifa = 0.00;\n    this.modalidadAnterior = 0;\n  }\n  ngOnInit() {\n    //fecha\n    const hoy = new Date();\n    const manana = new Date(hoy);\n    manana.setDate(hoy.getDate() + 2);\n    this.fechaMinima = manana.toISOString().split('T')[0];\n    this.servicio.fecha = this.fechaMinima;\n    // Cargar modalidades\n    this.modalidadService.getModalidades().subscribe({\n      next: d => this.modalidades = d,\n      error: err => console.error('Error al cargar modalidades:', err)\n    });\n    // Cargar distritos\n    this.distritoService.listar().subscribe({\n      next: d => this.distritos = d,\n      error: err => console.error('Error al cargar distritos:', err)\n    });\n    // Cargar horarios\n    this.horarioService.listar().subscribe({\n      next: h => this.horarios = h,\n      error: err => console.error('Error al cargar horarios:', err)\n    });\n    // Cargar tarifas por distrito\n    this.tarifaService.listar().subscribe({\n      next: t => this.tarifasDomicilio = t,\n      error: err => console.error('Error al cargar tarifas:', err)\n    });\n    this.servicioService.getServiciosInstalacion().subscribe({\n      next: s => this.servicios = s,\n      error: err => console.error('Error al cargar instalación:', err)\n    });\n    // // Cargar programas de reparación\n    // this.servicioService.getServiciosReparacion().subscribe({\n    //   next: (d: any[]) => this.programasReparacion = d,\n    //   error: (err: any) => console.error('Error al cargar reparación:', err)\n    // });\n    const token = localStorage.getItem('token');\n    const idCliente = Number(localStorage.getItem('id_cliente'));\n    if (token && idCliente) {\n      this.clienteService.obtenerCliente(idCliente, token).subscribe({\n        next: data => {\n          this.cliente = data;\n          this.nombreCompleto = `${this.cliente.nombres} ${this.cliente.apellidos}`;\n          this.servicio.id_cliente = this.cliente.id_cliente;\n        },\n        error: err => console.error('Error al cargar cliente:', err)\n      });\n    }\n    this.modalidadAnterior = this.servicio.modalidad;\n  }\n  validarNoDomingo() {\n    if (!this.servicio.fecha) return;\n    const [year, month, day] = this.servicio.fecha.split('-').map(Number);\n    // Crear fecha en horario local (sin conversiones raras)\n    const fecha = new Date(year, month - 1, day);\n    const diaSemana = fecha.getDay(); // 0 = domingo\n    if (diaSemana === 0) {\n      alert(\"No atendemos los domingos. Por favor elija otra fecha.\");\n      this.servicio.fecha = this.fechaMinima;\n    }\n  }\n  setearPrecio() {\n    const servicio = this.servicios.find(s => s.id_servicio == this.idServicioSeleccionado);\n    console.log('Servicio seleccionado:', servicio);\n    this.precioSeleccionado = servicio ? parseFloat(servicio.precio) : 0.00;\n    console.log('Precio actualizado:', this.precioSeleccionado);\n  }\n  get precioServicio() {\n    const n = Number(this.precioSeleccionado) || 0;\n    return n.toFixed(2);\n  }\n  validarModalidad() {\n    if (this.servicio.modalidad != 3) {\n      this.idDistritoSeleccionado = '';\n      this.servicio.direccion = '';\n      this.precioTarifa = 0;\n    }\n  }\n  setearTarifaDomicilio() {\n    if (!this.idDistritoSeleccionado) {\n      this.precioTarifa = 0;\n      return;\n    }\n    this.tarifaService.obtenerTarifaDistrito(this.idDistritoSeleccionado).subscribe({\n      next: resp => {\n        this.precioTarifa = parseFloat(resp.precio);\n        console.log(\"Precio obtenido:\", this.precioTarifa);\n      },\n      error: err => {\n        console.error(\"Error obteniendo tarifa:\", err);\n        this.precioTarifa = 0;\n      }\n    });\n  }\n  get tarifaDomicilio() {\n    const n = Number(this.precioTarifa) || 0;\n    return n.toFixed(2);\n  }\n  registrarServicio() {\n    //     if (!this.formularioValido()) {\n    //       alert('⚠️ Completa todos los campos obligatorios antes de registrar el servicio.');\n    //       return;\n  }\n  //    this.servicioService.registrarServicio(this.servicio).subscribe({\n  //       next: () => alert('✅ Servicio registrado correctamente'),\n  //       error: (err: any) => console.error('Error al registrar servicio:', err)\n  //     });\n  //}\n  formularioValido() {\n    return this.servicio.programa && this.servicio.distrito && this.servicio.precio > 0;\n  }\n};\nServiciosComponent = __decorate([Component({\n  selector: 'app-servicios',\n  templateUrl: './servicios.component.html',\n  styleUrls: ['./servicios.component.scss']\n})], ServiciosComponent);\nexport { ServiciosComponent };\n// actualizarPrecio(): void {\n//   // Precio base del servicio\n//   const servicio = [...this.programasInstalacion, ...this.programasReparacion]\n//     .find(s => s.id_servicio === this.servicio.programa);\n//   // Tarifa adicional por distrito\n//   const tarifa = this.tarifasDistritos.find(t => t.id_distrito === this.servicio.distrito);\n//   const precioServicio = servicio ? servicio.precio : 0;\n//   const precioDistrito = tarifa ? tarifa.precio : 0;\n//   this.servicio.precio = precioServicio + precioDistrito;\n// }\n// setearPrecio(idServicio: any): void {\n//   //console.log(this.servicios.id_servicio);\n//    if (idServicio) {\n//     const servicioSeleccionado = this.servicios.find(\n//     (servicio: {idServicio: Number}) => servicio.id_servicio == idServicio\n//   );\n//   console.log('Servicio seleccionado:', servicioSeleccionado);\n//   this.servicio.precio = servicioSeleccionado ? servicioSeleccionado.precio : 0;\n//   console.log('Precio actualizado:', this.servicio.precio);\n//    }\n//    this.servicio.precio = 0;\n//      console.log('Precio cero:', this.servicio.precio);\n//      return;\n// }","map":{"version":3,"mappings":"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","names":["Component","ServiciosComponent","constructor","modalidadService","distritoService","horarioService","servicioService","tarifaService","clienteService","descripcion_servicio","modalidad","distrito","direccion","fecha","hora","id_cliente","cliente","documento","comentario","precio_serviciot","precio_domicilio","ngOnInit","hoy","Date","manana","setDate","getDate","fechaMinima","toISOString","split","servicio","getModalidades","subscribe","next","d","modalidades","error","err","console","listar","distritos","h","horarios","t","tarifasDomicilio","getServiciosInstalacion","s","servicios","token","localStorage","getItem","idCliente","Number","obtenerCliente","data","nombreCompleto","nombres","apellidos","modalidadAnterior","validarNoDomingo","year","month","day","map","diaSemana","getDay","alert","setearPrecio","find","id_servicio","idServicioSeleccionado","log","precioSeleccionado","parseFloat","precio","precioServicio","n","toFixed","validarModalidad","idDistritoSeleccionado","precioTarifa","setearTarifaDomicilio","obtenerTarifaDistrito","resp","tarifaDomicilio","registrarServicio","formularioValido","programa","selector","templateUrl","styleUrls"],"sourceRoot":"","sources":["G:\\FrontendReyshell\\proyecto-web-soporte\\src\\app\\client-portal\\servicios_tecnicos\\servicios.component.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\r\nimport { ModalidadService } from 'src/app/services/modalidad.service';\r\nimport { DistritoService } from 'src/app/services/distrito.service';\r\nimport { HorarioService } from 'src/app/services/horario.service';\r\nimport { ServicioService } from 'src/app/services/servicio.service';\r\nimport { TarifaService } from 'src/app/services/tarifa.service';\r\nimport { ClienteService } from 'src/app/services/cliente.service';\r\n\r\n@Component({\r\n  selector: 'app-servicios',\r\n  templateUrl: './servicios.component.html',\r\n  styleUrls: ['./servicios.component.scss']\r\n})\r\nexport class ServiciosComponent implements OnInit {\r\n  servicios: any[] = [];\r\n  //programasInstalacion: any[] = [];\r\n  //programasReparacion: any[] = [];\r\n  modalidades: any[] = [];\r\n  distritos: any[] = [];\r\n  horarios: any[] = [];\r\n  tarifasDomicilio: any[] = [];\r\n  cliente: any = {};\r\n  nombreCompleto: string = '';\r\n\r\n  servicio: any = {\r\n    descripcion_servicio: '',\r\n    modalidad: '',\r\n    distrito: '',\r\n    direccion: '',\r\n    fecha: '',\r\n    hora: '',\r\n    id_cliente: this.cliente.id_cliente,\r\n    documento: '',\r\n    comentario: '',\r\n    precio_serviciot: 0.00,\r\n    precio_domicilio: 0.00,\r\n  };\r\n  \r\n\r\nidServicioSeleccionado: any = '';\r\nprecioSeleccionado: number = 0.00;\r\nfechaMinima: string = '';\r\n\r\nidDistritoSeleccionado: any = '';\r\nprecioTarifa: number = 0.00;\r\nmodalidadAnterior: number = 0;\r\n\r\n\r\n\r\n  constructor(\r\n    private modalidadService: ModalidadService,\r\n    private distritoService: DistritoService,\r\n    private horarioService: HorarioService,\r\n    private servicioService: ServicioService,\r\n    private tarifaService: TarifaService,\r\n    private clienteService: ClienteService\r\n  ) { }\r\n\r\n  ngOnInit(): void {\r\n    //fecha\r\n  const hoy = new Date();\r\n  const manana = new Date(hoy);\r\n  manana.setDate(hoy.getDate() + 2);\r\n  this.fechaMinima = manana.toISOString().split('T')[0];\r\n  this.servicio.fecha = this.fechaMinima;\r\n\r\n\r\n  \r\n    // Cargar modalidades\r\n    this.modalidadService.getModalidades().subscribe({\r\n      next: (d: any[]) => this.modalidades = d,\r\n      error: (err: any) => console.error('Error al cargar modalidades:', err)\r\n    });\r\n\r\n    // Cargar distritos\r\n    this.distritoService.listar().subscribe({\r\n      next: (d: any[]) => this.distritos = d,\r\n      error: (err: any) => console.error('Error al cargar distritos:', err)\r\n    });\r\n\r\n    // Cargar horarios\r\n    this.horarioService.listar().subscribe({\r\n      next: (h: any[]) => this.horarios = h,\r\n      error: (err: any) => console.error('Error al cargar horarios:', err)\r\n    });\r\n\r\n    // Cargar tarifas por distrito\r\n    this.tarifaService.listar().subscribe({\r\n      next: (t: any[]) => this.tarifasDomicilio = t,\r\n      error: (err: any) => console.error('Error al cargar tarifas:', err)\r\n    });\r\n    \r\n    this.servicioService.getServiciosInstalacion().subscribe({\r\n      next: (s: any[]) => this.servicios = s,\r\n      error: (err: any) => console.error('Error al cargar instalación:', err)\r\n    });\r\n\r\n\r\n    // // Cargar programas de reparación\r\n    // this.servicioService.getServiciosReparacion().subscribe({\r\n    //   next: (d: any[]) => this.programasReparacion = d,\r\n    //   error: (err: any) => console.error('Error al cargar reparación:', err)\r\n    // });\r\n\r\n    const token = localStorage.getItem('token');\r\n    const idCliente = Number(localStorage.getItem('id_cliente'));\r\n\r\n    if (token && idCliente) {\r\n      this.clienteService.obtenerCliente(idCliente, token).subscribe({\r\n        next: data => {\r\n          this.cliente = data;\r\n          this.nombreCompleto = `${this.cliente.nombres} ${this.cliente.apellidos}`;\r\n          this.servicio.id_cliente = this.cliente.id_cliente;\r\n        },\r\n        error: err => console.error('Error al cargar cliente:', err)\r\n      });\r\n    }\r\n\r\n    this.modalidadAnterior = this.servicio.modalidad;\r\n  }\r\n\r\n validarNoDomingo() {\r\n  if (!this.servicio.fecha) return;\r\n\r\n  const [year, month, day] = this.servicio.fecha.split('-').map(Number);\r\n\r\n  // Crear fecha en horario local (sin conversiones raras)\r\n  const fecha = new Date(year, month - 1, day);\r\n\r\n  const diaSemana = fecha.getDay(); // 0 = domingo\r\n\r\n  if (diaSemana === 0) {\r\n    alert(\"No atendemos los domingos. Por favor elija otra fecha.\");\r\n    this.servicio.fecha = this.fechaMinima;\r\n  }\r\n}\r\n\r\n\r\n  setearPrecio(): void {\r\n  const servicio = this.servicios.find(s => s.id_servicio == this.idServicioSeleccionado);\r\n  console.log('Servicio seleccionado:', servicio);\r\n  this.precioSeleccionado = servicio ? parseFloat(servicio.precio) : 0.00;\r\n  console.log('Precio actualizado:', this.precioSeleccionado);\r\n}\r\n\r\n\r\n\r\nget precioServicio(): string {\r\n  const n = Number(this.precioSeleccionado) || 0;\r\n  return n.toFixed(2); \r\n}\r\n\r\n validarModalidad() {\r\n   if (this.servicio.modalidad != 3) {\r\n     this.idDistritoSeleccionado = '';\r\n     this.servicio.direccion = '';\r\n     this.precioTarifa = 0;\r\n   }\r\n }\r\n\r\nsetearTarifaDomicilio(): void {\r\n  if (!this.idDistritoSeleccionado) {\r\n    this.precioTarifa = 0;\r\n    return;\r\n  }\r\n\r\n  this.tarifaService.obtenerTarifaDistrito(this.idDistritoSeleccionado)\r\n    .subscribe({\r\n      next: (resp) => {\r\n        this.precioTarifa = parseFloat(resp.precio);\r\n        console.log(\"Precio obtenido:\", this.precioTarifa);\r\n      },\r\n      error: (err) => {\r\n        console.error(\"Error obteniendo tarifa:\", err);\r\n        this.precioTarifa = 0;\r\n      }\r\n    });\r\n}\r\n\r\nget tarifaDomicilio(): string {\r\n  const n = Number(this.precioTarifa) || 0;\r\n  return n.toFixed(2); \r\n}\r\n\r\n\r\n   registrarServicio(): void {\r\n//     if (!this.formularioValido()) {\r\n//       alert('⚠️ Completa todos los campos obligatorios antes de registrar el servicio.');\r\n//       return;\r\n     }\r\n\r\n//    this.servicioService.registrarServicio(this.servicio).subscribe({\r\n//       next: () => alert('✅ Servicio registrado correctamente'),\r\n//       error: (err: any) => console.error('Error al registrar servicio:', err)\r\n//     });\r\n   //}\r\n\r\n   formularioValido(): boolean {\r\n    return this.servicio.programa && this.servicio.distrito && this.servicio.precio > 0;\r\n  }\r\n }\r\n\r\n\r\n  // actualizarPrecio(): void {\r\n  //   // Precio base del servicio\r\n  //   const servicio = [...this.programasInstalacion, ...this.programasReparacion]\r\n  //     .find(s => s.id_servicio === this.servicio.programa);\r\n\r\n  //   // Tarifa adicional por distrito\r\n  //   const tarifa = this.tarifasDistritos.find(t => t.id_distrito === this.servicio.distrito);\r\n\r\n  //   const precioServicio = servicio ? servicio.precio : 0;\r\n  //   const precioDistrito = tarifa ? tarifa.precio : 0;\r\n\r\n  //   this.servicio.precio = precioServicio + precioDistrito;\r\n  // }\r\n  // setearPrecio(idServicio: any): void {\r\n  //   //console.log(this.servicios.id_servicio);\r\n  //    if (idServicio) {\r\n  //     const servicioSeleccionado = this.servicios.find(\r\n  //     (servicio: {idServicio: Number}) => servicio.id_servicio == idServicio\r\n  //   );\r\n  //   console.log('Servicio seleccionado:', servicioSeleccionado);\r\n\r\n  //   this.servicio.precio = servicioSeleccionado ? servicioSeleccionado.precio : 0;\r\n  //   console.log('Precio actualizado:', this.servicio.precio);\r\n      \r\n  //    }\r\n  //    this.servicio.precio = 0;\r\n  //      console.log('Precio cero:', this.servicio.precio);\r\n  //      return;\r\n    \r\n  // }\r\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}